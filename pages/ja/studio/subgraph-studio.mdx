---
title: Subgraph Studioの使い方
---

新しいローンチパッドへようこそ 👩🏽‍🚀

Subgraph Studio は、サブグラフを構築・作成し、メタデータを追加して、新しい分散型エクスプローラーに公開するための場所です（詳細は[こちら](/explorer)）

Subgraph Studio でできること

- Studio UI によるサブグラフの作成
- CLI を使用したサブグラフのデプロイ
- Studio UI でサブグラフを公開する
- プレイグラウンドでのテスト
- クエリ URL を使用してステージングに統合する
- 特定のサブグラフ用の API キーの作成と管理

Subgraph Studio では、サブグラフを完全にコントロールすることができます。サブグラフを公開する前にテストできるだけでなく、API キーを特定のドメインに限定したり、特定のインデクサに API キーからのクエリを許可したりすることもできます。

サブグラフへのクエリはクエリフィーを発生させ、グラフネットワーク上の[インデクサー](/indexing)への報酬とします。dapp の開発者やサブグラフの開発者は、この Studio を利用することで、より優れたサブグラフを構築し、自分やコミュニティのクエリを強化することができます。Studio は 5 つの主要部分で構成されています。

- ユーザーアカウントの管理
- 作成したサブグラフのリスト
- A section to manage, view details and visualize the status of a specific subgraph
- サブグラフのクエリに必要な API キーを管理するセクション
- 請求書を管理するためのセクション

## アカウントの作成方法

1. お使いのウォレットでサインインします - MetaMask または WalletConnect で行うことができます。
1. Once you sign in, you will see your unique deploy key on your account home page. This will allow you to either publish your subgraphs or manage your API keys + billing. You will have a unique deploy key that can be re-generated if you think it has been compromised.

## Subgraph Studio でサブグラフを作成する方法

一番のポイントです - 最初にサブグラフを作成する際には、以下の項目を入力するように指示されます:

- サブグラフネーム
- 画像
- 説明
- カテゴリー
- ウェブサイト

## Subgraph と The Graph Network の互換性

The Graph Network は、Hosted Service で利用可能なデータソースや機能のすべてに対応しているわけではありません。ネットワーク上のインデクサでサポートされるためには、サブグラフは以下の条件を満たす必要があります。

- メインネット Ethereum のインデックス
- 以下の機能のいずれも使用してはいけません:
  - ipfs.cat & ipfs.map
  - Non-fatal errors
  - Grafting

The Graph Network の機能やネットワークは順次追加されていきます。

### サブグラフのライフサイクルフロー

![サブグラフのライフサイクル](/img/subgraph-lifecycle.png)

After you have created your subgraph, you will be able to deploy it using the [CLI](https://github.com/graphprotocol/graph-cli), or command-line interface. Deploying a subgraph with the CLI will push the subgraph to the Studio where you’ll be able to test subgraphs using the playground. This will eventually allow you to publish to the Graph Network. For more information on CLI setup, [check this out](/developer/define-subgraph-hosted#install-the-graph-cli) (pst, make sure you have your deploy key on hand). Remember, deploying is **not the same as** publishing. When you deploy a subgraph, you just push it to the Studio where you’re able to test it. Versus, when you publish a subgraph, you are publishing it on-chain.

## Subgraph Studio でのサブグラフのテスト

ネットワークに公開する前にサブグラフをテストしたい場合、Subgraph **Playground**でこれを行うか、ログを見ることができます。Subgraph のログは、サブグラフが失敗した場合に、**どこで**失敗したかを教えてくれます。

## Subgraph Studio でサブグラフを公開する

ここまで来ました - おめでとうございます。サブグラフの公開とは、CLI 内でサブグラフを展開した際に IPFS ハッシュが生成され、ネットワークの Ethereum スマートコントラクトに保存されることを意味します。サブグラフの公開を成功させるためには、この[ブログ](https://thegraph.com/blog/building-with-subgraph-studio)で紹介している以下のステップを踏む必要があります。以下のビデオ概要もチェックしてみてください。

<figure className="video-container">
  <iframe
    className="video-iframe"
    src="https://www.youtube.com/embed/HfDgC2oNnwo"
    title="YouTube ビデオプレイヤー"
    frameBorder="0"
    allowFullScreen
></iframe>
</figure>

Remember, while you’re going through your publishing flow, you’ll be able to push to either mainnet or Rinkeby, the testnet we support. If you’re a first-time subgraph developer, we highly suggest you start with publishing to Rinkeby, which is free to do. This will allow you to see how the subgraph will work in The Graph Explorer and will allow you to test curation elements.

メインネットのデータをインデックス化しているサブグラフのみがネットワークに公開できるため、メインネットからのデータのみをインデックス化することができます（サブグラフがテストネットに公開されていたとしても）。これは、インデクサが特定のブロック・ハッシュの時点で必須の Proof of Indexing レコードを提出する必要があるためです。サブグラフの公開はオンチェーンで行われるアクションであるため、トランザクションの実行には最大で数分かかることを覚えておいてください。コントラクトの公開に使用したアドレスは、将来のバージョンを公開できる唯一のアドレスとなります。賢い選択をしましょう

キュレーションシグナルを持つサブグラフは、分散型ネットワーク上でインデックスを作成できるようにインデクサーに表示されます。サブグラフとシグナルを 1 つのトランザクションで公開できるので、サブグラフの最初のキュレーションシグナルをミントすることができ、ガス代を節約することができます。また、キュレーターが後から提供するシグナルに自分のシグナルを加えることで、自分のサブグラフが最終的にクエリを提供する確率が高くなります。

**サブグラフの公開が完了したところで、次にサブグラフの定期的な管理方法について説明します。**同期に失敗したサブグラフは、ネットワークに公開できないことに注意してください。これは通常、サブグラフにバグがあるためで、ログを見ればどこに問題があるかがわかります。

## CLI によるサブグラフのバージョン管理

開発者は、さまざまな理由でサブグラフを更新したい場合があります。このような場合、CLI を使用してスタジオにサブグラフの新バージョンをデプロイし（この時点ではプライベートのみ）、新しいデプロイメントを The Graph Explorer に公開することができます。これにより、サブグラフの新しいバージョンが作成され、キュレーターはシグナリングを開始することができ、インデクサはこの新しいバージョンにインデックスを付けることができます。

Up until recently, developers were forced to deploy and publish a new version of their subgraph to the Explorer to update the metadata of their subgraphs. Now, developers can update the metadata of their subgraphs **without having to publish a new version**. Developers can update their subgraph details in the Studio (under the profile picture, name, description, etc) by checking an option called **Update Details** in The Graph Explorer. If this is checked, an on-chain transaction will be generated that updates subgraph details in the Explorer without having to publish a new version with a new deployment.

Please note that there are costs associated with publishing a new version of a subgraph to the network. In addition to the transaction fees, developers must also fund a part of the curation tax on the auto-migrating signal. You cannot publish a new version of your subgraph if curators have not signaled on it. For more information on the risks of curation, please read more [here](/curating).

### サブグラフのバージョンの自動アーカイブ

Subgraph Studio で新しいサブグラフのバージョンを展開すると、以前のバージョンがアーカイブされます。アーカイブされたバージョンはインデックス/同期されず、したがってクエリできません。Studio UI でサブグラフのアーカイブされたバージョンをアンアーカイブすることができます。スタジオにデプロイされた非公開のサブグラフの前のバージョンは、自動的にアーカイブされることに注意してください。

![Subgraph Studio - Unarchive](/img/Unarchive.png)

## API キーの管理

Dapp 開発者、サブグラフ開発者に関わらず、API キーを管理する必要があります。API キーは、アプリケーションサービス間の接続が有効で認証されていることを確認するため、サブグラフを照会できるようにするために重要です。これには、アプリケーションを使用するエンドユーザとデバイスの認証が含まれます。

スタジオでは、既存の API キーがリストアップされ、管理や削除が可能になります。

1. **Overview**セクションでは、以下のことができます:
   - キー名の編集
   - API キーの再生成
   - API キーの現在の使用状況を統計で表示:
     - クエリの数
     - 使用した GRT の量
2. **Security**では、APIキーの管理レベルに応じて、セキュリティ設定を選択することができます。このセクションでは、次のことが可能です：
   - API キーの使用を許可されたドメイン名の表示と管理
   - API キーでクエリ可能なサブグラフの割り当て
3. **Indexer Preference**では、あなたのAPIキーが使われているサブグラフのインデックスを作成しているIndexerに対して、異なるプリファレンスを設定することができるようになります。それぞれ最大5ポイントまで割り当てることができます：
   - **Fastest Speed**: クエリからインデクサーの応答までの時間。これを重要視すると、高速なインデクサーのために最適化されます。
   - **Lowest Price**: クエリごとに支払われる金額。これを重要視すると、より安価なインデクサに最適化されます。
   - **Data Freshness**: クエリしようとしているサブグラフについて、インデクサーが処理した最新のブロックの鮮度。これを重要視すると、最も新しいデータを持つインデクサを見つけるよう最適化されます。
   - **Economic Security**: もしクエリに対して誤った応答をした場合、インデクサーが失う可能性のある GRT の量。これを重要としてマークすると、私たちは大きなステーク量を持つインデクサーのために最適化します。
4. Under **Budget**, you’ll be able to update the maximum price per query. Note that we have a dynamic setting for that that's based on a volume discounting algorithm. **We strongly recommend using the default settings unless you are experiencing a specific problem.** Otherwise, you can update it under "Set a custom maximum budget". On this page you can also view different KPIs (in GRT and USD):
   - Average cost per query
   - Failed queries over max price
   - Most expensive query

## サブグラフの管理方法

API キー以外にも、サブグラフを管理するための様々なツールが用意されています。サブグラフは、**ステータス**や**カテゴリー**ごとに整理することができます。

- The **Status** tag allows you to pick between a variety of tags including `<created>`, `<deployed>`, `<published>`, `<archived>`, etc.
- Meanwhile, **Category** allows you to designate what category your subgraph falls into. Options include `<DeFi>`, `<NFTs>`, `<Governance>`, etc.
